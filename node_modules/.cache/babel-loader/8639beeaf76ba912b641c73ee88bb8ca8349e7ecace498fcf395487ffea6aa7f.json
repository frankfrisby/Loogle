{"ast":null,"code":"import { addBrowser } from './browser.js';\nimport { addNode } from './node.js';\n\n/**\n * Use the code directly to prevent import problems\n * with the detect-node package.\n * @link https://github.com/iliakan/detect-node/blob/master/index.js\n */\nvar isNode = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\nvar USE_METHOD = isNode ? addNode : addBrowser;\nvar LISTENERS = new Set();\nvar startedListening = false;\nfunction startListening() {\n  if (startedListening) {\n    return;\n  }\n  startedListening = true;\n  USE_METHOD(runAll);\n}\nexport function add(fn) {\n  startListening();\n  if (typeof fn !== 'function') {\n    throw new Error('Listener is no function');\n  }\n  LISTENERS.add(fn);\n  var addReturn = {\n    remove: function remove() {\n      return LISTENERS[\"delete\"](fn);\n    },\n    run: function run() {\n      LISTENERS[\"delete\"](fn);\n      return fn();\n    }\n  };\n  return addReturn;\n}\nexport function runAll() {\n  var promises = [];\n  LISTENERS.forEach(function (fn) {\n    promises.push(fn());\n    LISTENERS[\"delete\"](fn);\n  });\n  return Promise.all(promises);\n}\nexport function removeAll() {\n  LISTENERS.clear();\n}\nexport function getSize() {\n  return LISTENERS.size;\n}","map":{"version":3,"names":["addBrowser","addNode","isNode","Object","prototype","toString","call","process","USE_METHOD","LISTENERS","Set","startedListening","startListening","runAll","add","fn","Error","addReturn","remove","run","promises","forEach","push","Promise","all","removeAll","clear","getSize","size"],"sources":["C:/Users/frank/node_modules/unload/dist/es/index.js"],"sourcesContent":["import { addBrowser } from './browser.js';\nimport { addNode } from './node.js';\n\n/**\n * Use the code directly to prevent import problems\n * with the detect-node package.\n * @link https://github.com/iliakan/detect-node/blob/master/index.js\n */\nvar isNode = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\nvar USE_METHOD = isNode ? addNode : addBrowser;\nvar LISTENERS = new Set();\nvar startedListening = false;\nfunction startListening() {\n  if (startedListening) {\n    return;\n  }\n  startedListening = true;\n  USE_METHOD(runAll);\n}\nexport function add(fn) {\n  startListening();\n  if (typeof fn !== 'function') {\n    throw new Error('Listener is no function');\n  }\n  LISTENERS.add(fn);\n  var addReturn = {\n    remove: function remove() {\n      return LISTENERS[\"delete\"](fn);\n    },\n    run: function run() {\n      LISTENERS[\"delete\"](fn);\n      return fn();\n    }\n  };\n  return addReturn;\n}\nexport function runAll() {\n  var promises = [];\n  LISTENERS.forEach(function (fn) {\n    promises.push(fn());\n    LISTENERS[\"delete\"](fn);\n  });\n  return Promise.all(promises);\n}\nexport function removeAll() {\n  LISTENERS.clear();\n}\nexport function getSize() {\n  return LISTENERS.size;\n}"],"mappings":"AAAA,SAASA,UAAU,QAAQ,cAAc;AACzC,SAASC,OAAO,QAAQ,WAAW;;AAEnC;AACA;AACA;AACA;AACA;AACA,IAAIC,MAAM,GAAGC,MAAM,CAACC,SAAS,CAACC,QAAQ,CAACC,IAAI,CAAC,OAAOC,OAAO,KAAK,WAAW,GAAGA,OAAO,GAAG,CAAC,CAAC,KAAK,kBAAkB;AAChH,IAAIC,UAAU,GAAGN,MAAM,GAAGD,OAAO,GAAGD,UAAU;AAC9C,IAAIS,SAAS,GAAG,IAAIC,GAAG,EAAE;AACzB,IAAIC,gBAAgB,GAAG,KAAK;AAC5B,SAASC,cAAc,GAAG;EACxB,IAAID,gBAAgB,EAAE;IACpB;EACF;EACAA,gBAAgB,GAAG,IAAI;EACvBH,UAAU,CAACK,MAAM,CAAC;AACpB;AACA,OAAO,SAASC,GAAG,CAACC,EAAE,EAAE;EACtBH,cAAc,EAAE;EAChB,IAAI,OAAOG,EAAE,KAAK,UAAU,EAAE;IAC5B,MAAM,IAAIC,KAAK,CAAC,yBAAyB,CAAC;EAC5C;EACAP,SAAS,CAACK,GAAG,CAACC,EAAE,CAAC;EACjB,IAAIE,SAAS,GAAG;IACdC,MAAM,EAAE,SAASA,MAAM,GAAG;MACxB,OAAOT,SAAS,CAAC,QAAQ,CAAC,CAACM,EAAE,CAAC;IAChC,CAAC;IACDI,GAAG,EAAE,SAASA,GAAG,GAAG;MAClBV,SAAS,CAAC,QAAQ,CAAC,CAACM,EAAE,CAAC;MACvB,OAAOA,EAAE,EAAE;IACb;EACF,CAAC;EACD,OAAOE,SAAS;AAClB;AACA,OAAO,SAASJ,MAAM,GAAG;EACvB,IAAIO,QAAQ,GAAG,EAAE;EACjBX,SAAS,CAACY,OAAO,CAAC,UAAUN,EAAE,EAAE;IAC9BK,QAAQ,CAACE,IAAI,CAACP,EAAE,EAAE,CAAC;IACnBN,SAAS,CAAC,QAAQ,CAAC,CAACM,EAAE,CAAC;EACzB,CAAC,CAAC;EACF,OAAOQ,OAAO,CAACC,GAAG,CAACJ,QAAQ,CAAC;AAC9B;AACA,OAAO,SAASK,SAAS,GAAG;EAC1BhB,SAAS,CAACiB,KAAK,EAAE;AACnB;AACA,OAAO,SAASC,OAAO,GAAG;EACxB,OAAOlB,SAAS,CAACmB,IAAI;AACvB"},"metadata":{},"sourceType":"module","externalDependencies":[]}